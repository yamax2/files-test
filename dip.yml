version: '3.3'

environment:
  DOCKER_TLD: localhost
  DOCKER_RUBY_VERSION: 2.7

compose:
  files:
    - docker-compose.yml
  project_name: klara-files

interaction:
  sh:
    service: uploader

  cc:
    service: uploader
    command: bundle exec pry

  bundle:
    service: uploader
    command: bundle

  web:
    service: uploader
    command: bundle exec puma -C puma.rb

  rubocop:
    service: uploader
    command: bundle exec ./rubocop

provision:
  - docker volume create --name bundler_data
  - mkdir -p upload
  - dip bundle install
